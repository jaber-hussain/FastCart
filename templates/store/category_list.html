{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<style>
  /* Tiny custom tweaks â€“ optional if you already have Bootstrap 5 */
  .card-hover { transition: transform .2s; }
  .card-hover:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,.12); }
  .sticky-sidebar { position: sticky; top: 80px; }
  @media (max-width: 767px) {
    .sticky-sidebar { margin-bottom: 2rem; }
  }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="row">
    <!-- ========== SIDEBAR ========== -->
    <div class="col-lg-3 mb-4">
      <div class="card sticky-sidebar">
        <div class="card-header bg-primary text-white">
          <h6 class="mb-0">Categories</h6>
        </div>
        <ul class="list-group list-group-flush">
          {% for c in categories %}
            <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
               href="{% url 'store:category_detail' c.slug %}">
              {{ c.title }}
              <span class="badge bg-secondary rounded-pill">{{ c.product_count }}</span>
            </a>
          {% empty %}
            <li class="list-group-item text-muted">No categories yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <!-- ========== MAIN GRID ========== -->
    <div class="col-lg-9">
      <h2 class="mb-4">Browse Categories</h2>
      <div class="row g-3">
        {% for c in categories %}
          <div class="col-6 col-md-4 col-xl-3">
            <div class="card h-100 card-hover">
              {% if c.image %}
                <img src="{{ c.image.url }}" class="card-img-top" alt="{{ c.title }}" style="height:160px; object-fit:cover;">
              {% else %}
                <div class="d-flex align-items-center justify-content-center bg-light text-muted"
                     style="height:160px; font-size:3rem;">
                  <i class="bi bi-folder2-open"></i>
                </div>
              {% endif %}
              <div class="card-body d-flex flex-column">
                <h6 class="card-title">{{ c.title }}</h6>
                <p class="text-muted small">{{ c.product_count }} item{{ c.product_count|pluralize }}</p>
                <a href="{% url 'store:category_detail' c.slug %}" class="btn btn-sm btn-outline-primary mt-auto">
                  View Products
                </a>
              </div>
            </div>
          </div>
        {% empty %}
          <div class="col-12">
            <div class="alert alert-info">No categories published yet.</div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}